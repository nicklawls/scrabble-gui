<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Scrabble</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.14/d3.js"></script>
        <script type="text/javascript" src="app.js"></script>
    </head>

    <body style="margin:0; padding:0;">
        <script>
            window.addEventListener(
                'load',
                function () {
                    var app = Elm.fullscreen(Elm.Main, {recieveGame:""});


                    app.ports.sendMove.subscribe(sendMoveHandler);


                    function sendMoveHandler(move) {
                        console.log("Your move: " + move);
                    }

                    function Client(socket) {
                        socket.onopen = function () {
                          // TODO: need a real way for players to enter their name
                          socket.send("bob");
                          console.log("conn open, sent fake name");
                        }
                        socket.onclose = function () {
                          console.log("closed web socket");
                        }
                        socket.onerror = function (event) {
                          console.log(event);
                        }

                        socket.onmessage = function (event) {
                          // TODO: here is where magic must happen.
                          // we must have gotten a new game, or an error message
                          // check, and if its a new game, update the ui, and
                          // if its this players turn, let them enter a word.
                          // (check if it's this players turn by their name...
                          // and id...which we still don't have yet. for not thats okay.
                          console.log("Message for you: ");
                          console.log(event.data);
                          app.ports.recieveGame.send(event.data);
                        }
                    }

                    socket = new WebSocket("ws://localhost:8000/");
                    client = new Client(socket)

                },
                false
            );
        </script>
    </body>
</html>
